import{_ as t,c as i,a0 as a,o as e}from"./chunks/framework.Dz46SkuX.js";const y=JSON.parse('{"title":"内存数据库 Chariot.memdb","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"jsapi_memdb.md","filePath":"jsapi_memdb.md"}'),l={name:"jsapi_memdb.md"};function h(n,s,k,p,d,E){return e(),i("div",null,s[0]||(s[0]=[a(`<h1 id="内存数据库-chariot-memdb" tabindex="-1">内存数据库 Chariot.memdb <a class="header-anchor" href="#内存数据库-chariot-memdb" aria-label="Permalink to &quot;内存数据库 Chariot.memdb&quot;">​</a></h1><p>本模块用 sqlite3 的 :memory: 来实现，只是存储在内存中，并非真正意义上的内存数据库。 本模块为了简单的数据处理和应用逻辑而存在，所有操作都基于同一个数据库连接，不支持事务，需自行处理数据完整和安全性。 复杂的需求请使用 sqlite3 扩展。</p><h2 id="execute" tabindex="-1">Chariot.memdb.execute(sql, if_fetch) <a class="header-anchor" href="#execute" aria-label="Permalink to &quot;Chariot.memdb.execute(sql, if_fetch) {#execute}&quot;">​</a></h2><p>执行 SQL 语句</p><table tabindex="0"><thead><tr><th style="text-align:center;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">sql</td><td style="text-align:left;">string</td><td style="text-align:left;">SQL 语句</td></tr><tr><td style="text-align:center;">if_fetch</td><td style="text-align:left;">bool</td><td style="text-align:left;">是否返回数据</td></tr></tbody></table><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">如果 if_fetch 为 true，返回游标的数据对象。</td></tr><tr><td style="text-align:left;">null</td><td style="text-align:left;">如果 if_fetch 为 false，返回 null，<br>需通过后继的 fetch 操作获取数据。</td></tr></tbody></table><h2 id="fetchone" tabindex="-1">Chariot.memdb.fetchone() <a class="header-anchor" href="#fetchone" aria-label="Permalink to &quot;Chariot.memdb.fetchone() {#fetchone}&quot;">​</a></h2><p>获取游标数据（一条）</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table><h2 id="fetchall" tabindex="-1">Chariot.memdb.fetchall() <a class="header-anchor" href="#fetchall" aria-label="Permalink to &quot;Chariot.memdb.fetchall() {#fetchall}&quot;">​</a></h2><p>获取游标所有数据</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table><h2 id="fetchmany" tabindex="-1">Chariot.memdb.fetchmany(count) <a class="header-anchor" href="#fetchmany" aria-label="Permalink to &quot;Chariot.memdb.fetchmany(count) {#fetchmany}&quot;">​</a></h2><p>获取游标数据（指定记录条数）</p><table tabindex="0"><thead><tr><th style="text-align:center;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">count</td><td style="text-align:left;">number</td><td style="text-align:left;">要获取的记录条数</td></tr></tbody></table><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table><h2 id="getrowcount" tabindex="-1">Chariot.memdb.getrowcount() <a class="header-anchor" href="#getrowcount" aria-label="Permalink to &quot;Chariot.memdb.getrowcount() {#getrowcount}&quot;">​</a></h2><p>获取受影响的记录数</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">number</td><td style="text-align:left;">受影响的数据库记录数</td></tr></tbody></table><h2 id="getlastrowid" tabindex="-1">Chariot.memdb.getlastrowid() <a class="header-anchor" href="#getlastrowid" aria-label="Permalink to &quot;Chariot.memdb.getlastrowid() {#getlastrowid}&quot;">​</a></h2><p>获取受上次操作影响的数据库记录id</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">number</td><td style="text-align:left;">数据库记录id</td></tr></tbody></table><h2 id="一个综合的例子" tabindex="-1">一个综合的例子 <a class="header-anchor" href="#一个综合的例子" aria-label="Permalink to &quot;一个综合的例子&quot;">​</a></h2><p>在这个例子中，首先创建了表 COMPANY，接着向其插入了记录，然后进行查询、更新、删除等操作。并在最后删除了这张表。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CREATE TABLE COMPANY (ID INT PRIMARY KEY NOT NULL, NAME TEXT NOT NULL, AGE INT NOT NULL, ADDRESS CHAR(50), SALARY REAL)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM sqlite_master WHERE type=&#39;table&#39; ORDER BY name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PRAGMA table_info(COMPANY)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (1, &#39;Paul&#39;, 32, &#39;California&#39;, 20000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (2, &#39;Allen&#39;, 25, &#39;Texas&#39;, 15000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (3, &#39;Teddy&#39;, 23, &#39;Norway&#39;, 20000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (4, &#39;Mark&#39;, 25, &#39;Rich-Mond &#39;, 65000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (5, &#39;David&#39;, 27, &#39;Texas&#39;, 85000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (6, &#39;Kim&#39;, 22, &#39;South-Hall&#39;, 45000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getlastrowid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM COMPANY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getrowcount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchmany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UPDATE COMPANY SET NAME=&#39;Peter&#39; WHERE ID=1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getrowcount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getlastrowid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DELETE FROM COMPANY WHERE ID&gt;4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getrowcount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getlastrowid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __C.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DROP TABLE COMPANY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div>`,25)]))}const g=t(l,[["render",h]]);export{y as __pageData,g as default};
